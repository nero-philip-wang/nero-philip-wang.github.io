<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于 GitFlow 的版本控制 | nero.wang 的博客</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.9c97aa0f.css" as="style"><link rel="preload" href="/assets/js/app.1455245f.js" as="script"><link rel="preload" href="/assets/js/2.b1c8daab.js" as="script"><link rel="preload" href="/assets/js/11.e1cdf63a.js" as="script"><link rel="prefetch" href="/assets/js/10.4a2775ab.js"><link rel="prefetch" href="/assets/js/12.1a70e979.js"><link rel="prefetch" href="/assets/js/13.fdced5ec.js"><link rel="prefetch" href="/assets/js/14.0a14f5da.js"><link rel="prefetch" href="/assets/js/3.e237bab9.js"><link rel="prefetch" href="/assets/js/4.865692a8.js"><link rel="prefetch" href="/assets/js/5.81254301.js"><link rel="prefetch" href="/assets/js/6.6e8c67be.js"><link rel="prefetch" href="/assets/js/7.7db5dc92.js"><link rel="prefetch" href="/assets/js/8.2ff7ad83.js"><link rel="prefetch" href="/assets/js/9.3318232a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9c97aa0f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">nero.wang 的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Github</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Workflow</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/03.workflow/gitflow.html" aria-current="page" class="active sidebar-link">基于 GitFlow 的版本控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#编写的目的" class="sidebar-link">编写的目的</a></li><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#前提" class="sidebar-link">前提</a></li><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#gitflow-工作流程图" class="sidebar-link">GitFlow 工作流程图</a></li><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#环境-版本对应关系" class="sidebar-link">环境-版本对应关系</a></li><li class="sidebar-sub-header"><a href="/03.workflow/gitflow.html#怎么做" class="sidebar-link">怎么做</a></li></ul></li><li><a href="/03.workflow/orm.html" class="sidebar-link">如何通过 ORM 实现从面向数据库编程到面向对象编程的转变</a></li><li><a href="/03.workflow/structure.html" class="sidebar-link">项目结构说明</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基于-gitflow-的版本控制"><a href="#基于-gitflow-的版本控制" class="header-anchor">#</a> 基于 GitFlow 的版本控制</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>在多组员，多项目等环境进行协同工作时，如果没有统一规范、统一流程，则会导致额外的工作量。所以要减少版本冲突，减轻不必要的工作，就需要规范化的工作流程，来避免版本和分支管理混乱，无法快速响应客户变更和bugfix。</p> <h2 id="编写的目的"><a href="#编写的目的" class="header-anchor">#</a> 编写的目的</h2> <ul><li>通过规范化的流程，使得产品、开发与测试等各个部门更高效的协同工作。</li> <li>规范化的流程也是建立持续交付的基础，而持续交付也是微服务的基础。</li></ul> <h2 id="前提"><a href="#前提" class="header-anchor">#</a> 前提</h2> <h3 id="提交的准则"><a href="#提交的准则" class="header-anchor">#</a> 提交的准则</h3> <ul><li>除了源码相关的文件，其他build产生的东西（如：obj文件夹，bin 文件夹等），均不能提交进入源码仓库，添加到.gitignore文件中忽略掉。</li> <li>尽量减少二进制文件的提交，文档尽量以 markdown 编写，以便可以显示变化记录。</li> <li>撰写规范的提交说明。一份好的提交说明可以帮助协作者更轻松更有效地配合工作。</li> <li>要严格按照我们指定的流程切换到指定分支，开发相应的功能。</li></ul> <h3 id="版本号管理"><a href="#版本号管理" class="header-anchor">#</a> 版本号管理</h3> <p>本文采用以下的版本号方案：主版本号 . 次版本号 . 修正版本号</p> <ul><li>主版本号，正式版本从1开始，测试版本可以从0开始，当出现软件架构、设计思想改变或大量重写，主版本号+1，也代表不再向后兼容。</li> <li>次版本号，当有较大增加或变更了功能，涉及数据库的改动等次版本号+1。在敏捷开发中，一般1-2周更新一次。</li> <li>修正版本号，当修复软件bug或者微小业务逻辑调整不该懂数据库时，修正版本号+1。</li> <li>在数据库中，也应该记录数据结构的版本号，运行时应该检查数据结构和软件的版本号是否一致。</li></ul> <h3 id="运行环境说明"><a href="#运行环境说明" class="header-anchor">#</a> 运行环境说明</h3> <ul><li>生产环境，对应用户使用的最新版本。</li> <li>UAT 环境，对应用户测试版本，组织用户验收和内测的版本。</li> <li>SIT 环境，对应内部测试版本，公司内部测试人员测试的版本，测试通过后提交到 UAT 环境。</li> <li>开发环境，对应开发人员对接联调的版本。</li></ul> <h2 id="gitflow-工作流程图"><a href="#gitflow-工作流程图" class="header-anchor">#</a> GitFlow 工作流程图</h2> <p><img src="https://static001.geekbang.org/wechat/images/1e/1e42a49e59659d9c232cd85aed834e59.png" alt=""></p> <h3 id="master"><a href="#master" class="header-anchor">#</a> master</h3> <ul><li>master 生产分支，是用户当前版本所在的分支，对应发布到生产环境和 UAT 环境。</li> <li>你不能直接在 master 分支上提交，可以通过 release 和 hotfix 分支合并。</li> <li>每个版本的发布都是对应一个带有版本 tag 的提交。</li> <li>该分支应该自动编译部署到 UAT 环境。</li></ul> <h3 id="develop"><a href="#develop" class="header-anchor">#</a> develop</h3> <ul><li>develop 开发分支，是当前发开的最新进度，该分支应该自动编译部署到开发环境。</li> <li>由各个成员的 feature 分支合并而来。</li></ul> <h3 id="feature"><a href="#feature" class="header-anchor">#</a> feature</h3> <ul><li>feature 功能分支，用来开发一个新的功能。</li> <li>每个 feature 分支，应该是由成员通过最新的 develop 分支创建而来。</li> <li>成员在完成分支并自测通过后，将确保代码可以编译成功，然后合并到develop（可以通过 git hooks 来确保）。</li></ul> <h3 id="release"><a href="#release" class="header-anchor">#</a> release</h3> <ul><li>release 发布分支，当 develop 版本的准备提测时应生成该分支，该分支应该自动编译部署到 SIT 环境。</li> <li>该分支由 develop 分支创建而来，只能用来修复测试中的 bug。创建该分支，会确定本次发布版本的 tag ，当首次提交 SIT 时，次版本号+1。</li> <li>SIT 测试无误后，应该合并到 develop 和 master ，转到 UAT 测试步骤。</li> <li>在 UAT 中，如果也出现了需要修改的地方，应该创建新的 release 分支，修正版本号+1。</li></ul> <h3 id="hotfix"><a href="#hotfix" class="header-anchor">#</a> hotfix</h3> <ul><li>hotfix 补丁分支，当我们在生产环境发现 bug 时通过该分支来快速响应，该分支应该自动编译部署到 UAT 环境。</li> <li>由 master 分支创建，完成后合并回 master 和 develop 分支。创建新的 hotfix 分支时，修正版本号+1</li></ul> <h2 id="环境-版本对应关系"><a href="#环境-版本对应关系" class="header-anchor">#</a> 环境-版本对应关系</h2> <table><thead><tr><th>环境</th> <th>分支</th> <th>备注</th></tr></thead> <tbody><tr><td>生产环境</td> <td>mater</td> <td>手动发布</td></tr> <tr><td>UAT 环境</td> <td>mater + hotfix</td> <td>自动编译发布</td></tr> <tr><td>SIT 环境</td> <td>release</td> <td>测试指定版本发布</td></tr> <tr><td>开发环境</td> <td>develop</td> <td>自动编译发布</td></tr></tbody></table> <h2 id="怎么做"><a href="#怎么做" class="header-anchor">#</a> 怎么做</h2> <p>我们按照的windows 版本的 git 自带 gitflow 工作流程</p> <div class="language-cmd extra-class"><pre class="language-text"><code>git flow init '初始化 gitflow
git flow feature start *** '创建feature分支
git flow feature finish  ***
git flow release start 1.1.5  '创建release分支
git flow release finish 1.1.5
git flow hotfix start ***  '创建hotfix分支
git flow hotfix finish ***
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">6/7/2023, 9:27:25 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/02.docker/dockerfile.html" class="prev">
        构建自己的 docker 镜像
      </a></span> <span class="next"><a href="/03.workflow/orm.html">
        如何通过 ORM 实现从面向数据库编程到面向对象编程的转变
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1455245f.js" defer></script><script src="/assets/js/2.b1c8daab.js" defer></script><script src="/assets/js/11.e1cdf63a.js" defer></script>
  </body>
</html>
